# 首个人形机器人漏洞 PoC 完全公开，可实现命令注入

发布时间: 

近期，由安全研究员 Bin4ry 和 h0stile 公布的一项研究揭示了 Unitree
旗下多款主流机器人存在一个严重的安全漏洞。该漏洞允许攻击者通过蓝牙（BLE）远程执行任意代码，取得最高控制权

这是业界首次公开披露针对人形机器人的完整利用链，虽然不复杂，但也在提醒我们具身智能在快速发展的同时，其安全性也应当得到重视。

> https://github.com/Bin4ry/UniPwn

## **潜伏在蓝牙功能中的漏洞**

本次漏洞的核心在于 Unitree 机器人用于配置 Wi-Fi
网络的蓝牙低功耗（BLE）服务接口。研究人员发现，这个看似不起眼的功能，却因一连串的安全疏忽，成为了一个可被远程利用的致命入口。

该漏洞组合了多种经典的安全问题：

  1. 1\. **硬编码加密密钥** ：所有设备使用相同的、写死在固件中的 AES 加密密钥和初始向量（IV）。
  2. 2\. **可绕过的身份认证** ：所谓的“安全握手”机制形同虚设。
  3. 3\. **命令注入** ：系统在处理 Wi-Fi 配置参数时，未对用户输入进行充分过滤和净化，直接拼接成系统命令并以 root 权限执行。

受影响的型号包括 Unitree Go2、G1、H1、B2 等多款主力机器人。

## **技术细节**

攻击者要完全控制一台机器人，只需遵循一个清晰的攻击流程。研究人员通过逆向工程，完整地剖析了其通信协议和内部处理逻辑。

##### **第一步：发现 BLE 服务与“安全”握手**

所有受影响的 Unitree 机器人都会暴露一个自定义的 BLE 服务，用于 Wi-Fi 配置。攻击者首先需要连接到这个服务。

  * • **服务 UUID** : `0000ffe0-0000-1000-8000-00805f9b34fb`
  * • **写入特征** : `0000ffe2-0000-1000-8000-00805f9b34fb`

机器人与客户端之间的通信数据包经过了 AES-CFB128 加密。然而，加密所需的密钥（KEY）和初始向量（IV）被硬编码在固件中，对所有设备都是相同的。

  * • **AES_KEY** : `df98b715d5c6ed2b25817b6f2554124a`
  * • **AES_IV** : `2841ae97419c2973296a0d4bdfe19a4f`

这意味着，任何获取到固件的攻击者都能解密通信内容。更令人惊讶的是其“认证”机制：攻击者只需将字符串 `"unitree"`
加密后发送给机器人，即可通过所谓的“握手验证”，获得后续操作的权限。这层防御几乎不存在任何实际意义。

##### **第二步：利用 Wi-Fi 设置注入恶意命令**

通过认证后，攻击者便可以调用一系列内部指令。其中，设置 Wi-Fi 的 SSID（无线网络名称）和密码的指令成为了命令注入的关键点。

当用户通过 BLE 设置 SSID 时，机器人会将接收到的数据存储起来，但并未对内容进行任何安全检查。攻击者可以将恶意的 Shell 命令巧妙地嵌入
SSID 字符串中。

例如，一个典型的注入载荷（Payload）如下：

    
    
    ";$(reboot -f);#

这个字符串的意图是：

  * • `"`: 闭合前面命令的引号。
  * • `;`: 分隔多条命令。
  * • `$(reboot -f)`: 核心恶意指令，强制重启机器人。
  * • `#`: 注释掉后续可能存在的原始命令部分，确保语法正确。

##### **第三步：触发漏洞执行**

恶意载荷被设置为 SSID 后，并不会立即执行。攻击者还需要发送最后一条指令——设置 Wi-Fi 国家代码。这条指令会触发一个名为
`WifiSettingThreadFunction` 的线程，该线程负责应用新的 Wi-Fi 配置。

在这个线程中，系统会调用 `restart_wifi_ap` 或 `restart_wifi_sta` 函数。问题的根源就在这里，该函数会动态构建一条
Shell 命令，并将先前存储的 SSID 和密码不加过滤地拼接进去：

    
    
    sudo sh /unitree/module/network_manager/upper_bluetooth/hostapd_restart.sh "wifi_ssid wifi_pass"

当 `wifi_ssid` 是我们构造的恶意载荷时，最终传递给 `system()` 函数执行的命令就变成了：

    
    
    sudo sh ... " ";$(reboot -f);#" "some_password"

操作系统会依次执行这些指令，最终导致 `reboot -f` 命令以 root
权限被执行，机器人被强制重启。当然，重启只是一个简单的示例，攻击者完全可以替换成上传后门、窃取数据、开启 SSH 等更复杂的恶意指令。

## 小结

从之前 Go1
系列的后门问题（CVE-2025-2894），到如今最新产品中存在的命令注入漏洞，反映出具身智能领域中安全设计的滞后性。具身智能仍处于探索发展期，厂商和投资人的关注力主要放在了具身智能落地实现上，对于安全问题的不重视也正源于此。具身智能由于增加了与真实世界的交互，其安全性不局限于传统的代码层漏洞，比如openai有一位员工利用大模型实现了自动瞄准设计的装置，随后openai发表声明将其开除。在未来的发展中，我们可能会看到具身智能领域更多不一样的安全问题凸显出来。

  

